<%- include('partials/header') %>

<style>
    .registry-wrapper {
        font-family: 'Inter', Arial, sans-serif;
        padding: 10px 20px;
        max-width: 1200px;
        margin: 0 auto;
    }

    .form-card {
        background: white; border-radius: 12px; border: 1px solid var(--border); 
        box-shadow: 0 4px 6px -1px rgb(0 0 0 / 0.05); padding: 24px; margin-bottom: 24px;
        display: flex; gap: 16px; align-items: stretch;
    }

    .input-wrapper { flex-grow: 1; position: relative; }
    .main-input { 
        width: 100%; padding: 12px 16px; border: 1px solid var(--border); 
        border-radius: 8px; font-size: 14px; outline: none; background: #f8fafc;
        transition: all 0.2s; box-sizing: border-box;
    }
    .main-input:focus { border-color: var(--primary); background: #ffffff; box-shadow: 0 0 0 3px rgba(16, 185, 129, 0.1); }

    .btn-submit { 
        background: var(--primary); color: white; border: none; padding: 0 24px; 
        border-radius: 8px; font-weight: 700; font-size: 14px; cursor: pointer; 
        transition: all 0.2s; white-space: nowrap; display: flex; align-items: center; gap: 8px;
    }
    .btn-submit:hover { background: #059669; }

    /* Hotel Tags Grid */
    .hotel-container {
        background: white; border-radius: 12px; border: 1px solid var(--border); 
        padding: 24px; box-shadow: 0 4px 6px -1px rgb(0 0 0 / 0.05);
    }
    .search-filter {
        width: 100%; padding: 10px 14px 10px 36px; border: 1px solid var(--border); 
        border-radius: 8px; font-size: 14px; outline: none; margin-bottom: 20px;
        background: #f8fafc url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="%2394a3b8" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line></svg>') no-repeat 12px center;
    }

    .hotel-grid { display: flex; flex-wrap: wrap; gap: 10px; }
    .hotel-tag { 
        background: #eff6ff; border: 1px solid #bfdbfe; color: #1e3a8a; 
        padding: 8px 12px; border-radius: 8px; font-size: 13px; font-weight: 600; 
        display: inline-flex; align-items: center; gap: 8px; transition: all 0.2s;
    }
    .hotel-tag:hover { background: #dbeafe; }
    
    .btn-remove { 
        background: rgba(255,255,255,0.5); border: none; color: #60a5fa; 
        cursor: pointer; padding: 2px; border-radius: 4px; display: flex; 
        align-items: center; justify-content: center; transition: all 0.2s; 
    }
    .btn-remove:hover { background: #fee2e2; color: #dc2626; }

    @media (max-width: 768px) {
        .form-card { flex-direction: column; }
        .btn-submit { padding: 12px; justify-content: center; }
    }
</style>

<div class="registry-wrapper">
    <div style="margin-bottom: 24px;">
        <h1 style="margin: 0; font-size: 24px; color:#0f172a;">Hotel Registry</h1>
        <p style="color: #64748b; margin: 4px 0 0 0;">Manage the Master List used by the AI Sanitizer and Vendor Routing mappings.</p>
    </div>

    <form action="/registry/add" method="POST" class="form-card">
        <div class="input-wrapper">
            <input type="text" name="hotel_name" class="main-input" placeholder="Type the EXACT official name of the hotel..." required autocomplete="off">
        </div>
        <button type="submit" class="btn-submit">
            <i data-lucide="plus" style="width: 18px;"></i> Add to Master List
        </button>
    </form>

    <div class="hotel-container">
        <input type="text" id="filterInput" class="search-filter" placeholder="Search saved hotels...">
        
        <div class="hotel-grid" id="hotelGrid">
            <% hotels.forEach(hotel => { %>
                <div class="hotel-tag" data-name="<%= hotel.name.toLowerCase() %>">
                    <%= hotel.name %>
                    <form action="/registry/remove" method="POST" style="margin: 0;">
                        <input type="hidden" name="hotel_id" value="<%= hotel.id %>">
                        <button type="submit" class="btn-remove" title="Remove from Registry">
                            <i data-lucide="x" style="width: 14px; height: 14px;"></i>
                        </button>
                    </form>
                </div>
            <% }); %>
            
            <% if(hotels.length === 0) { %>
                <div style="color: #94a3b8; font-style: italic; font-size: 13px;">No hotels found in the registry.</div>
            <% } %>
        </div>
    </div>
</div>

<%- include('partials/footer') %>

<script>
    document.addEventListener("DOMContentLoaded", () => {
        const filterInput = document.getElementById('filterInput');
        const hotelTags = document.querySelectorAll('.hotel-tag');

        // Instant local search filter
        filterInput.addEventListener('input', (e) => {
            const term = e.target.value.toLowerCase().trim();
            hotelTags.forEach(tag => {
                const name = tag.getAttribute('data-name');
                if (name.includes(term)) {
                    tag.style.display = 'inline-flex';
                } else {
                    tag.style.display = 'none';
                }
            });
        });
    });
</script>